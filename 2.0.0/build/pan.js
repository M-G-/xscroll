define('kg/xscroll/2.0.0/pan',["./util","./event"],function(require, exports, module) {function t(t){if(!(t.touches.length>1||this.gestureType&&"pan"!=this.gestureType))if(""==this.gestureType&&(s=[]),s.length){if("pan"!=this.gestureType)return;n.deltaX=t.touches[0].clientX-n.startX,n.deltaY=t.touches[0].clientY-n.startY,n.directionX=t.touches[0].clientX-n.prevX>0?"right":"left",n.directionY=t.touches[0].clientY-n.prevY>0?"bottom":"top",n.prevX=t.touches[0].clientX,n.prevY=t.touches[0].clientY,t.touch=n,s.push({deltaX:n.deltaX,deltaY:n.deltaY,timeStamp:t.timeStamp}),t.deltaX=n.deltaX,t.deltaY=n.deltaY,t.velocityX=0,t.velocityY=0,t.directionX=n.directionX,t.directionY=n.directionY,c.dispatchEvent(t.target,r,t)}else n={},n.startX=t.touches[0].clientX,n.startY=t.touches[0].clientY,n.deltaX=0,n.deltaY=0,t.touch=n,n.prevX=n.startX,n.prevY=n.startY,s.push({deltaX:n.deltaX,deltaY:n.deltaY,timeStamp:t.timeStamp}),t.deltaX=n.deltaX,t.deltaY=n.deltaY,this.gestureType="pan",c.dispatchEvent(t.target,o,t)}function e(t){var e=0,o=0,r=0;if(!(t.touches.length>1)){n.deltaX=t.changedTouches[0].clientX-n.startX,n.deltaY=t.changedTouches[0].clientY-n.startY,t.deltaX=n.deltaX,t.deltaY=n.deltaY,t.touch=n,t.touch.record=s;var h=(t.touch.startX,t.touch.startY,s.length),d=s[0]&&s[0].timeStamp;if(!(2>h)&&d){{s[h-1].timeStamp-s[0].timeStamp}for(var X in s)X>0?(s[X].velocity=a(s[X].deltaX,s[X].deltaY,s[X-1].deltaX,s[X-1].deltaY)/(s[X].timeStamp-s[X-1].timeStamp),s[X].velocityX=(s[X].deltaX-s[X-1].deltaX)/(s[X].timeStamp-s[X-1].timeStamp),s[X].velocityY=(s[X].deltaY-s[X-1].deltaY)/(s[X].timeStamp-s[X-1].timeStamp)):(s[X].velocity=0,s[X].velocityX=0,s[X].velocityY=0);var Y=s[0].velocityX/Math.abs(s[0].velocityX);for(var X in s)s[X].velocityX/Math.abs(s[X].velocityX)!=Y&&(Y=s[X].velocityX/Math.abs(s[X].velocityX),r=X);var u=s[0].velocityY/Math.abs(s[0].velocityY);for(var X in s)s[X].velocityY/Math.abs(s[X].velocityY)!=u&&(u=s[X].velocityY/Math.abs(s[X].velocityY),o=X);e=Math.max(r,o);{s[e]}t.touch.record=t.touch.record.splice(e-1);var y=i(t.touch.record);t.velocityX=Math.abs(y.velocityX)>v?y.velocityX/Math.abs(y.velocityX)*v:y.velocityX,t.velocityY=Math.abs(y.velocityY)>v?y.velocityY/Math.abs(y.velocityY)*v:y.velocityY,t.velocity=Math.sqrt(Math.pow(t.velocityX,2)+Math.pow(t.velocityY,2)),n={},s=[],"pan"==this.gestureType&&(c.dispatchEvent(t.target,l,t),this.gestureType="")}}}function a(t,e,a,i){return Math.sqrt(Math.pow(a-t,2)+Math.pow(i-e,2))}function i(t){for(var e=0,a=0,i=t.length,c=0;i>c;c++)e+=t[c].velocityY,a+=t[c].velocityX;return e/=i,a/=i,{velocityY:Math.abs(t[i-1].velocityY)>h?e:0,velocityX:Math.abs(t[i-1].velocityX)>h?a:0}}var c=(require("./util"),require("./event")),o=(window.document,"panstart"),l="panend",r="pan",h=.35,v=8,n={},s=[];document.addEventListener("touchmove",t),document.addEventListener("touchend",e);});