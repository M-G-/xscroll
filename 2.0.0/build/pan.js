KISSY.add('kg/xscroll/2.0.0/pan',["./util","./event"],function(S ,require, exports, module) {define(function(t){function e(t){if(!(t.touches.length>1||this.gestureType&&"pan"!=this.gestureType))if(""==this.gestureType&&(s=[]),s.length){if("pan"!=this.gestureType)return;d.deltaX=t.touches[0].clientX-d.startX,d.deltaY=t.touches[0].clientY-d.startY,d.directionX=t.touches[0].clientX-d.prevX>0?"right":"left",d.directionY=t.touches[0].clientY-d.prevY>0?"bottom":"top",d.prevX=t.touches[0].clientX,d.prevY=t.touches[0].clientY,t.touch=d,s.push({deltaX:d.deltaX,deltaY:d.deltaY,timeStamp:t.timeStamp}),t.deltaX=d.deltaX,t.deltaY=d.deltaY,t.velocityX=0,t.velocityY=0,t.directionX=d.directionX,t.directionY=d.directionY,o.dispatchEvent(t.target,n,t)}else d={},d.startX=t.touches[0].clientX,d.startY=t.touches[0].clientY,d.deltaX=0,d.deltaY=0,t.touch=d,d.prevX=d.startX,d.prevY=d.startY,s.push({deltaX:d.deltaX,deltaY:d.deltaY,timeStamp:t.timeStamp}),t.deltaX=d.deltaX,t.deltaY=d.deltaY,this.gestureType="pan",o.dispatchEvent(t.target,l,t)}function a(t){var e=0,a=0,l=0;if(!(t.touches.length>1)){d.deltaX=t.changedTouches[0].clientX-d.startX,d.deltaY=t.changedTouches[0].clientY-d.startY,t.deltaX=d.deltaX,t.deltaY=d.deltaY,t.touch=d,t.touch.record=s;var n=(t.touch.startX,t.touch.startY,s.length),h=s[0]&&s[0].timeStamp;if(!(2>n)&&h){{s[n-1].timeStamp-s[0].timeStamp}for(var X in s)X>0?(s[X].velocity=i(s[X].deltaX,s[X].deltaY,s[X-1].deltaX,s[X-1].deltaY)/(s[X].timeStamp-s[X-1].timeStamp),s[X].velocityX=(s[X].deltaX-s[X-1].deltaX)/(s[X].timeStamp-s[X-1].timeStamp),s[X].velocityY=(s[X].deltaY-s[X-1].deltaY)/(s[X].timeStamp-s[X-1].timeStamp)):(s[X].velocity=0,s[X].velocityX=0,s[X].velocityY=0);var Y=s[0].velocityX/Math.abs(s[0].velocityX);for(var X in s)s[X].velocityX/Math.abs(s[X].velocityX)!=Y&&(Y=s[X].velocityX/Math.abs(s[X].velocityX),l=X);var u=s[0].velocityY/Math.abs(s[0].velocityY);for(var X in s)s[X].velocityY/Math.abs(s[X].velocityY)!=u&&(u=s[X].velocityY/Math.abs(s[X].velocityY),a=X);e=Math.max(l,a);{s[e]}t.touch.record=t.touch.record.splice(e-1);var y=c(t.touch.record);t.velocityX=Math.abs(y.velocityX)>v?y.velocityX/Math.abs(y.velocityX)*v:y.velocityX,t.velocityY=Math.abs(y.velocityY)>v?y.velocityY/Math.abs(y.velocityY)*v:y.velocityY,t.velocity=Math.sqrt(Math.pow(t.velocityX,2)+Math.pow(t.velocityY,2)),d={},s=[],"pan"==this.gestureType&&(o.dispatchEvent(t.target,r,t),this.gestureType="")}}}function i(t,e,a,i){return Math.sqrt(Math.pow(a-t,2)+Math.pow(i-e,2))}function c(t){for(var e=0,a=0,i=t.length,c=0;i>c;c++)e+=t[c].velocityY,a+=t[c].velocityX;return e/=i,a/=i,{velocityY:Math.abs(t[i-1].velocityY)>h?e:0,velocityX:Math.abs(t[i-1].velocityX)>h?a:0}}var o=(t("./util"),t("./event")),l=(window.document,"panstart"),r="panend",n="pan",h=.35,v=8,d={},s=[];return document.addEventListener("touchmove",e),document.addEventListener("touchend",a),{PAN_START:l,PAN_END:r,PAN:n}});});