define('kg/xscroll/2.0.0/xlist',["./util","./core","./dataset","./swipeedit"],function(require, exports, module) {define(function(e,t,i){var n=e("./util"),s=e("./core"),o=e("./dataset"),a=e("./swipeedit"),r=n.prefixStyle("transform"),l=function(e){this.super.call(this,e)};return l.DataSet=o,l.SwipeEdit=a,n.extend(s,l,{init:function(){{var e=this;e.userConfig=n.mix({data:[],gpuAcceleration:!0,lockX:!0,scrollbarX:!1,itemHeight:30},e.userConfig)}this.super.prototype.init.call(this),e._initInfinite()},_getDomInfo:function(){var e=this,t=e._formatData(),i=e.userConfig.itemHeight,n=0,s=[],o=0;e.hasSticky=!1,e.userConfig.maxSpeed=.06*i;for(var a=0,r=t.length;r>a;a++){var l=t[a];o=l.style&&l.style.height>=0?l.style.height:i,l._row=a,l._top=n,l._height=o,l.recycled=l.recycled===!1?!1:!0,s.push(l),n+=o,!e.hasSticky&&l.style&&"sticky"==l.style.position&&(e.hasSticky=!0)}return e.domInfo=s,s},appendDataSet:function(e){var t=this;!e instanceof o||t.datasets.push(e)},removeDataSet:function(e){var t=this;if(e){for(var i,n=0,s=t.datasets.length;s>n;n++)e==t.datasets[n].getId()&&(i=n);t.datasets.splice(i,1)}},_fireTouchStart:function(e){var t=this.getCellByPageY(e.touches[0].pageY);e.cell=t,this._curTouchedCell=t,this.super.prototype._fireTouchStart.call(this,e)},_firePanStart:function(e){var t=this.getCellByPageY(e.touch.startY);e.cell=t,this._curTouchedCell=t,this.super.prototype._firePanStart.call(this,e)},_firePan:function(e){this._curTouchedCell&&(e.cell=this._curTouchedCell),this.super.prototype._firePan.call(this,e)},_firePanEnd:function(e){this._curTouchedCell&&(e.cell=this._curTouchedCell),this.super.prototype._firePanEnd.call(this,e),this._curTouchedCell=null},_fireClick:function(e,t){var i=this.getCellByPageY(t.pageY);t.cell=i,this.super.prototype._fireClick.call(this,e,t)},getCellByPageY:function(e){var t=this,i=e-t.renderTo.offsetTop+Math.abs(t.getOffsetTop());return t.getCellByOffsetY(i)},getCellByRow:function(e){var t,i=this;if("number"==typeof e&&e<i.domInfo.length)for(var n=0;n<i.infiniteLength;n++)if(e==i.infiniteElementsCache[n]._row)return t=i.domInfo[i.infiniteElementsCache[n]._row],t.element=i.infiniteElements[n],t},getCellByOffsetY:function(e){var t,i=this,n=i.domInfo.length;if(!(0>e))for(var s=0;n>s;s++)if(t=i.domInfo[s],t._top<e&&t._top+t._height>e)return i.getCellByRow(s)},insertData:function(e,t,i){var n=this;i&&e>=0&&n.datasets[e]&&t>=0},getData:function(e,t){var i=this;return e>=0&&i.datasets[e]&&t>=0?i.datasets[e].getData(t):void 0},updateData:function(e,t,i){var n=this,s=n.getData(e,t);return s.data=i},removeData:function(e,t){var i=this;return e>=0&&i.datasets[e]&&t>=0?i.datasets[e].removeData(t):void 0},getDataSets:function(){var e=this;return e.datasets},getDataSetById:function(e){var t=this;if(e)for(var i=0,n=t.datasets.length;n>i;i++)if(t.datasets[i].getId()==e)return t.datasets[i]},_formatData:function(){var e=this,t=[];for(var i in e.datasets)t=t.concat(e.datasets[i].getData());return t},_getChangedRows:function(e,t){var i=this,n={};for(var s in i.elementsPos)e.hasOwnProperty(s)||(n[s]="delete");for(var s in e)!e[s].recycled||i.elementsPos.hasOwnProperty(s)&&!t||(n[s]="add");return i.elementsPos=e,n},_getElementsPos:function(e){for(var t,i=this,e=-(e||i.getOffsetTop()),n=i.domInfo,s=i.userConfig.itemHeight,o=Math.ceil(i.height/s),a=Math.max(Math.ceil(o/3),1),r=Math.max(e-a*s,0),l={},f=0,c=n.length;c>f;f++)t=n[f],t._top>=r-s&&t._top<=r+2*a*s+i.height&&(l[t._row]=t);return l},render:function(){var e=this;this.super.prototype.render.call(this),e._getDomInfo(),e._initSticky();var t=e.height,i=e.domInfo[e.domInfo.length-1],n=i&&i._top?i._top+i._height:e.height;t>n&&(n=t),e.containerHeight=n,e.container.style.height=n,e.renderScrollBars(),e._renderNoRecycledEl(),e._update(e.getOffsetTop(),!0)},_update:function(e,t){var i=this,n=i.userConfig.gpuAcceleration?" translateZ(0) ":"",e=void 0===e?i.getOffsetTop():e,s=i._getElementsPos(e),o=i._getChangedRows(s,t),a=null;if(t)for(var l=0;l<i.infiniteLength;l++)i.infiniteElementsCache[l]._visible=!1,i.infiniteElements[l].style.visibility="hidden",delete i.infiniteElementsCache[l]._row;var f=function(){for(var e=0;e<i.infiniteLength;e++)if(!i.infiniteElementsCache[e]._visible)return i.infiniteElementsCache[e]._visible=!0,e},c=function(e){for(var t=0;t<i.infiniteLength;t++)i.infiniteElementsCache[t]._row==e&&(i.infiniteElementsCache[t]._visible=!1,i.infiniteElements[t].style.visibility="hidden",delete i.infiniteElementsCache[t]._row)};for(var l in o)if("delete"==o[l]&&c(l),"add"==o[l]){var h=f(s[l]._row);if(a=i.infiniteElements[h]){i.infiniteElementsCache[h]._row=s[l]._row;for(var d in s[l].style)"height"!=d&&"display"!=d&&"position"!=d&&(a.style[d]=s[l].style[d]);a.style.visibility="visible",a.style.height=s[l]._height+"px",a.style[r]="translateY("+s[l]._top+"px) "+n,i.userConfig.renderHook.call(i,a,s[l])}}},_renderNoRecycledEl:function(){var e=this,t=e.userConfig.gpuAcceleration?" translateZ(0) ":"";for(var i in e.domInfo)if(e.domInfo[i].recycled===!1){var n=e.domInfo[i].id&&document.getElementById(e.domInfo[i].id.replace("#",""))||document.createElement("div"),s="ks-xlist-row-"+Date.now();n.id=e.domInfo[i].id||s,e.domInfo[i].id=n.id,e.content.appendChild(n);for(var o in e.domInfo[i].style)"height"!=o&&"display"!=o&&"position"!=o&&(n.style[o]=e.domInfo[i].style[o]);n.style.top=0,n.style.position="absolute",n.style.display="block",n.style.height=e.domInfo[i]._height+"px",n.style[r]="translateY("+e.domInfo[i]._top+"px) "+t,e.domInfo[i].className&&(n.className=e.domInfo[i].className),e.userConfig.renderHook.call(e,n,e.domInfo[i])}},_initSticky:function(){var e=this;if(e.hasSticky&&!e._isStickyRendered){e._isStickyRendered=!0;var t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.display="none",e.renderTo.appendChild(t),e.stickyElement=t,e.stickyDomInfo=[];for(var i=0,n=e.domInfo.length;n>i;i++)e.domInfo[i]&&e.domInfo[i].style&&"sticky"==e.domInfo[i].style.position&&e.stickyDomInfo.push(e.domInfo[i]);e.stickyDomInfoLength=e.stickyDomInfo.length}},_stickyHandler:function(e){var t=this;if(t.stickyDomInfoLength){for(var i=Math.abs(e),n=[],s=[],o=0;o<t.stickyDomInfoLength;o++)s.push(t.stickyDomInfo[o]._top),i>=t.stickyDomInfo[o]._top&&n.push(o);if(!n.length)return t.stickyElement.style.display="none",void(t.curStickyIndex=void 0);var a=Math.max.apply(null,n);if(t.curStickyIndex!==a){t.curStickyIndex=a,t.userConfig.renderHook.call(t,t.stickyElement,t.stickyDomInfo[t.curStickyIndex]),t.stickyElement.style.display="block",t.stickyElement.style.height=t.stickyDomInfo[t.curStickyIndex].style.height+"px",t.stickyElement.className=t.stickyDomInfo[t.curStickyIndex].className||"";for(var r in t.stickyDomInfo[t.curStickyIndex].style)"height"!=r&&"display"!=r&&"position"!=r&&(t.stickyElement.style[r]=t.stickyDomInfo[t.curStickyIndex].style[r])}return-e<Math.min.apply(null,s)?(t.stickyElement.style.display="none",void(t.curStickyIndex=void 0)):void 0}},enableGPUAcceleration:function(){var e=this;e.super.prototype.enableGPUAcceleration.call(e);for(var t=0;t<e.infiniteLength;t++)/translateZ/.test(e.infiniteElements[t].style[r])||(e.infiniteElements[t].style[r]+=" translateZ(0)")},disableGPUAcceleration:function(){var e=this;e.super.prototype.disableGPUAcceleration.call(e);for(var t=0;t<e.infiniteLength;t++)e.infiniteElements[t].style[r]=e.infiniteElements[t].style[r].replace(/translateZ\(0px\)/,"")},_initInfinite:function(){var e=this,t=e.userConfig.infiniteElements;e.datasets=[],e.userConfig.data&&e.userConfig.data.length&&e.datasets.push(new o({data:e.userConfig.data})),e.infiniteElements=e.renderTo.querySelectorAll(t),e.infiniteLength=e.infiniteElements.length,e.infiniteElementsCache=function(){for(var t=[],i=0;i<e.infiniteLength;i++)t.push({}),e.infiniteElements[i].style.position="absolute",e.infiniteElements[i].style.top=0,e.infiniteElements[i].style.visibility="hidden",e.infiniteElements[i].style.display="block";return t}(),e.elementsPos={},e.on("scroll",function(t){e._update(t.offset.y),e._stickyHandler(t.offset.y)})}}),"object"==typeof i&&i.exports?i.exports=l:window.XList=l,l});});